ReLIC -- True
Saving Model In -- save/newrelic, Train Epochs: 100
All Training Args -- Namespace(nodes=1, gpus=1, nr=0, dataparallel=0, workers=8, dataset_dir='./datasets', seed=42, batch_size=64, image_size=224, start_epoch=0, epochs=100, dataset='CIFAR10', test_dataset='STL10', pacs_style='default', pretrain=False, relic=True, relic_normalize=True, relic_temp=1.0, relic_alpha=0.5, resnet='resnet18', projection_dim=64, optimizer='LARS', weight_decay=1e-06, temperature=0.5, model_path='save/newrelic', epoch_num=100, reload=False, logistic_batch_size=256, logistic_epochs=500, device=device(type='cuda', index=0), num_gpus=4, world_size=1)
Files already downloaded and verified
Step [0/781]	 Loss: 6.007460594177246
Step [50/781]	 Loss: 5.290698051452637
Step [100/781]	 Loss: 5.184952735900879
Step [150/781]	 Loss: 5.0655317306518555
Step [200/781]	 Loss: 5.161766052246094
Step [250/781]	 Loss: 5.120516300201416
Step [300/781]	 Loss: 5.328440189361572
Step [350/781]	 Loss: 5.109003067016602
Step [400/781]	 Loss: 5.025861740112305
Step [450/781]	 Loss: 5.036487102508545
Step [500/781]	 Loss: 4.971022605895996
Step [550/781]	 Loss: 5.079917907714844
Step [600/781]	 Loss: 4.920708656311035
Step [650/781]	 Loss: 4.838188171386719
Step [700/781]	 Loss: 4.856044769287109
Step [750/781]	 Loss: 4.811448097229004
Epoch [0/100]	 Loss: 5.057046954976764	 lr: 0.075
Step [0/781]	 Loss: 4.815540313720703
Step [50/781]	 Loss: 4.783844947814941
Step [100/781]	 Loss: 4.90529727935791
Step [150/781]	 Loss: 4.662786483764648
Step [200/781]	 Loss: 4.856342315673828
Step [250/781]	 Loss: 4.821298599243164
Step [300/781]	 Loss: 4.888980865478516
Step [350/781]	 Loss: 4.717625617980957
Step [400/781]	 Loss: 4.885398864746094
Step [450/781]	 Loss: 4.909240245819092
Step [500/781]	 Loss: 4.618836402893066
Step [550/781]	 Loss: 4.626805305480957
Step [600/781]	 Loss: 4.789568901062012
Step [650/781]	 Loss: 4.737034320831299
Step [700/781]	 Loss: 4.718564987182617
Step [750/781]	 Loss: 5.008700370788574
Epoch [1/100]	 Loss: 4.797604085235986	 lr: 0.07498
Step [0/781]	 Loss: 4.816512107849121
Step [50/781]	 Loss: 4.814377784729004
Step [100/781]	 Loss: 4.638143539428711
Step [150/781]	 Loss: 4.58023738861084
Step [200/781]	 Loss: 4.764710426330566
Step [250/781]	 Loss: 4.773342609405518
Step [300/781]	 Loss: 4.6387434005737305
Step [350/781]	 Loss: 4.623247146606445
Step [400/781]	 Loss: 4.600208282470703
Step [450/781]	 Loss: 4.794306755065918
Step [500/781]	 Loss: 4.460261344909668
Step [550/781]	 Loss: 4.817601680755615
Step [600/781]	 Loss: 4.7601823806762695
Step [650/781]	 Loss: 4.614895820617676
Step [700/781]	 Loss: 4.601505279541016
Step [750/781]	 Loss: 4.714847564697266
Epoch [2/100]	 Loss: 4.658480474494025	 lr: 0.07493
Step [0/781]	 Loss: 4.482762336730957
Step [50/781]	 Loss: 4.586796760559082
Step [100/781]	 Loss: 4.731070041656494
Step [150/781]	 Loss: 4.583569526672363
Step [200/781]	 Loss: 4.675989151000977
Step [250/781]	 Loss: 4.549241065979004
Step [300/781]	 Loss: 4.631383895874023
Step [350/781]	 Loss: 4.3825483322143555
Step [400/781]	 Loss: 4.684210777282715
Step [450/781]	 Loss: 4.613884449005127
Step [500/781]	 Loss: 4.613052845001221
Step [550/781]	 Loss: 4.552156448364258
Step [600/781]	 Loss: 4.417335510253906
Step [650/781]	 Loss: 4.567746162414551
Step [700/781]	 Loss: 4.566298961639404
Step [750/781]	 Loss: 4.612161636352539
Epoch [3/100]	 Loss: 4.571707268225246	 lr: 0.07483
Step [0/781]	 Loss: 4.452462196350098
Step [50/781]	 Loss: 4.56333065032959
Step [100/781]	 Loss: 4.611752033233643
Step [150/781]	 Loss: 4.556972503662109
Step [200/781]	 Loss: 4.721612930297852
Step [250/781]	 Loss: 4.538776397705078
Step [300/781]	 Loss: 4.483774662017822
Step [350/781]	 Loss: 4.503453254699707
Step [400/781]	 Loss: 4.628121852874756
Step [450/781]	 Loss: 4.487710475921631
Step [500/781]	 Loss: 4.504710674285889
Step [550/781]	 Loss: 4.478480815887451
Step [600/781]	 Loss: 4.337134838104248
Step [650/781]	 Loss: 4.419490814208984
Step [700/781]	 Loss: 4.526326656341553
Step [750/781]	 Loss: 4.327469348907471
Epoch [4/100]	 Loss: 4.514965909086024	 lr: 0.0747
Step [0/781]	 Loss: 4.544947624206543
Step [50/781]	 Loss: 4.4036760330200195
Step [100/781]	 Loss: 4.484646797180176
Step [150/781]	 Loss: 4.358983039855957
Step [200/781]	 Loss: 4.580388069152832
Step [250/781]	 Loss: 4.541651248931885
Step [300/781]	 Loss: 4.371438026428223
Step [350/781]	 Loss: 4.503582954406738
Step [400/781]	 Loss: 4.449548244476318
Step [450/781]	 Loss: 4.435947418212891
Step [500/781]	 Loss: 4.569397449493408
Step [550/781]	 Loss: 4.435098648071289
Step [600/781]	 Loss: 4.55660343170166
Step [650/781]	 Loss: 4.415214538574219
Step [700/781]	 Loss: 4.463875770568848
Step [750/781]	 Loss: 4.40366268157959
Epoch [5/100]	 Loss: 4.466878316466543	 lr: 0.07454
Step [0/781]	 Loss: 4.414101600646973
Step [50/781]	 Loss: 4.473953723907471
Step [100/781]	 Loss: 4.515293121337891
Step [150/781]	 Loss: 4.4627180099487305
Step [200/781]	 Loss: 4.453427314758301
Step [250/781]	 Loss: 4.361424922943115
Step [300/781]	 Loss: 4.419173717498779
Step [350/781]	 Loss: 4.478795051574707
Step [400/781]	 Loss: 4.6547393798828125
Step [450/781]	 Loss: 4.424191474914551
Step [500/781]	 Loss: 4.653717994689941
Step [550/781]	 Loss: 4.367077827453613
Step [600/781]	 Loss: 4.3698296546936035
Step [650/781]	 Loss: 4.490477085113525
Step [700/781]	 Loss: 4.475404262542725
Step [750/781]	 Loss: 4.5179972648620605
Epoch [6/100]	 Loss: 4.437695090505134	 lr: 0.07434
Step [0/781]	 Loss: 4.511857032775879
Step [50/781]	 Loss: 4.271428108215332
Step [100/781]	 Loss: 4.4828925132751465
Step [150/781]	 Loss: 4.352538585662842
Step [200/781]	 Loss: 4.2661237716674805
Step [250/781]	 Loss: 4.40110969543457
Step [300/781]	 Loss: 4.442464828491211
Step [350/781]	 Loss: 4.366529941558838
Step [400/781]	 Loss: 4.322630882263184
Step [450/781]	 Loss: 4.38484001159668
Step [500/781]	 Loss: 4.470480442047119
Step [550/781]	 Loss: 4.4006805419921875
Step [600/781]	 Loss: 4.388186454772949
Step [650/781]	 Loss: 4.327118873596191
Step [700/781]	 Loss: 4.469398021697998
Step [750/781]	 Loss: 4.32404899597168
Epoch [7/100]	 Loss: 4.405256831844393	 lr: 0.0741
Step [0/781]	 Loss: 4.460390567779541
Step [50/781]	 Loss: 4.560245513916016
Step [100/781]	 Loss: 4.284628868103027
Step [150/781]	 Loss: 4.344708442687988
Step [200/781]	 Loss: 4.3716840744018555
Step [250/781]	 Loss: 4.205150127410889
Step [300/781]	 Loss: 4.400264739990234
Step [350/781]	 Loss: 4.344139099121094
Step [400/781]	 Loss: 4.3252058029174805
Step [450/781]	 Loss: 4.31643009185791
Step [500/781]	 Loss: 4.412945747375488
Step [550/781]	 Loss: 4.337818622589111
Step [600/781]	 Loss: 4.367392539978027
Step [650/781]	 Loss: 4.28379487991333
Step [700/781]	 Loss: 4.335529804229736
Step [750/781]	 Loss: 4.3292717933654785
Epoch [8/100]	 Loss: 4.37202619926267	 lr: 0.07382
Step [0/781]	 Loss: 4.282792568206787
Step [50/781]	 Loss: 4.383235931396484
Step [100/781]	 Loss: 4.2561845779418945
Step [150/781]	 Loss: 4.511226654052734
Step [200/781]	 Loss: 4.32958984375
Step [250/781]	 Loss: 4.207337379455566
Step [300/781]	 Loss: 4.332746982574463
Step [350/781]	 Loss: 4.313880920410156
Step [400/781]	 Loss: 4.535749912261963
Step [450/781]	 Loss: 4.219969749450684
Step [500/781]	 Loss: 4.382325649261475
Step [550/781]	 Loss: 4.4418182373046875
Step [600/781]	 Loss: 4.374675273895264
Step [650/781]	 Loss: 4.205713748931885
Step [700/781]	 Loss: 4.449121952056885
Step [750/781]	 Loss: 4.364188194274902
Epoch [9/100]	 Loss: 4.338682161250585	 lr: 0.07351
Step [0/781]	 Loss: 4.296708106994629
Step [50/781]	 Loss: 4.334526062011719
Step [100/781]	 Loss: 4.341340065002441
Step [150/781]	 Loss: 4.334907054901123
Step [200/781]	 Loss: 4.2392730712890625
Step [250/781]	 Loss: 4.188179016113281
Step [300/781]	 Loss: 4.410099506378174
Step [350/781]	 Loss: 4.2747039794921875
Step [400/781]	 Loss: 4.20884895324707
Step [450/781]	 Loss: 4.201187610626221
Step [500/781]	 Loss: 4.348734378814697
Step [550/781]	 Loss: 4.4416704177856445
Step [600/781]	 Loss: 4.429760932922363
Step [650/781]	 Loss: 4.352798938751221
Step [700/781]	 Loss: 4.371735095977783
Step [750/781]	 Loss: 4.328732013702393
Epoch [10/100]	 Loss: 4.326279139549265	 lr: 0.07316
Step [0/781]	 Loss: 4.235877990722656
Step [50/781]	 Loss: 4.402105808258057
Step [100/781]	 Loss: 4.200645923614502
Step [150/781]	 Loss: 4.294214248657227
Step [200/781]	 Loss: 4.289902687072754
Step [250/781]	 Loss: 4.296324729919434
Step [300/781]	 Loss: 4.3119049072265625
Step [350/781]	 Loss: 4.266928195953369
Step [400/781]	 Loss: 4.389117240905762
Step [450/781]	 Loss: 4.336071968078613
Step [500/781]	 Loss: 4.5174713134765625
Step [550/781]	 Loss: 4.327415466308594
Step [600/781]	 Loss: 4.296411991119385
Step [650/781]	 Loss: 4.434901714324951
Step [700/781]	 Loss: 4.367800235748291
Step [750/781]	 Loss: 4.29807186126709
Epoch [11/100]	 Loss: 4.3071668352574	 lr: 0.07278
Step [0/781]	 Loss: 4.3114824295043945
Step [50/781]	 Loss: 4.22922420501709
Step [100/781]	 Loss: 4.354299545288086
Step [150/781]	 Loss: 4.2390265464782715
Step [200/781]	 Loss: 4.339154243469238
Step [250/781]	 Loss: 4.361618995666504
Step [300/781]	 Loss: 4.362454891204834
Step [350/781]	 Loss: 4.450719833374023
Step [400/781]	 Loss: 4.249108791351318
Step [450/781]	 Loss: 4.327877521514893
Step [500/781]	 Loss: 4.273952484130859
Step [550/781]	 Loss: 4.369333744049072
Step [600/781]	 Loss: 4.272029876708984
Step [650/781]	 Loss: 4.340221405029297
Step [700/781]	 Loss: 4.219815254211426
Step [750/781]	 Loss: 4.202034950256348
Epoch [12/100]	 Loss: 4.294166234635513	 lr: 0.07237
Step [0/781]	 Loss: 4.182648658752441
Step [50/781]	 Loss: 4.332597732543945
Step [100/781]	 Loss: 4.25908899307251
Step [150/781]	 Loss: 4.322621822357178
Step [200/781]	 Loss: 4.2378010749816895
Step [250/781]	 Loss: 4.3336591720581055
Step [300/781]	 Loss: 4.183188438415527
Step [350/781]	 Loss: 4.3103346824646
Step [400/781]	 Loss: 4.278728008270264
Step [450/781]	 Loss: 4.307539939880371
Step [500/781]	 Loss: 4.386734962463379
Step [550/781]	 Loss: 4.256572246551514
Step [600/781]	 Loss: 4.370868682861328
Step [650/781]	 Loss: 4.365814208984375
Step [700/781]	 Loss: 4.2785725593566895
Step [750/781]	 Loss: 4.287288665771484
Epoch [13/100]	 Loss: 4.274512879521837	 lr: 0.07192
Step [0/781]	 Loss: 4.265871047973633
Step [50/781]	 Loss: 4.233962535858154
Step [100/781]	 Loss: 4.32633113861084
Step [150/781]	 Loss: 4.205317497253418
Step [200/781]	 Loss: 4.220249652862549
Step [250/781]	 Loss: 4.2549896240234375
Step [300/781]	 Loss: 4.465252876281738
Step [350/781]	 Loss: 4.188394546508789
Step [400/781]	 Loss: 4.329462051391602
Step [450/781]	 Loss: 4.327207565307617
Step [500/781]	 Loss: 4.255967140197754
Step [550/781]	 Loss: 4.240602493286133
Step [600/781]	 Loss: 4.274848937988281
Step [650/781]	 Loss: 4.134786605834961
Step [700/781]	 Loss: 4.184418201446533
Step [750/781]	 Loss: 4.200505256652832
Epoch [14/100]	 Loss: 4.262450172409663	 lr: 0.07143
Step [0/781]	 Loss: 4.306873321533203
Step [50/781]	 Loss: 4.243737697601318
Step [100/781]	 Loss: 4.323671340942383
Step [150/781]	 Loss: 4.233742713928223
Step [200/781]	 Loss: 4.259751319885254
Step [250/781]	 Loss: 4.24814510345459
Step [300/781]	 Loss: 4.382143974304199
Step [350/781]	 Loss: 4.294153213500977
Step [400/781]	 Loss: 4.344541072845459
Step [450/781]	 Loss: 4.28149938583374
Step [500/781]	 Loss: 4.1227216720581055
Step [550/781]	 Loss: 4.282614707946777
Step [600/781]	 Loss: 4.2587175369262695
Step [650/781]	 Loss: 4.336026668548584
Step [700/781]	 Loss: 4.132198810577393
Step [750/781]	 Loss: 4.150386810302734
Epoch [15/100]	 Loss: 4.254976662722501	 lr: 0.07091
Step [0/781]	 Loss: 4.3584184646606445
Step [50/781]	 Loss: 4.343669891357422
Step [100/781]	 Loss: 4.243882179260254
Step [150/781]	 Loss: 4.279877662658691
Step [200/781]	 Loss: 4.17873477935791
Step [250/781]	 Loss: 4.1348066329956055
Step [300/781]	 Loss: 4.270556926727295
Step [350/781]	 Loss: 4.329479217529297
Step [400/781]	 Loss: 4.241060256958008
Step [450/781]	 Loss: 4.155651092529297
Step [500/781]	 Loss: 4.23708438873291
Step [550/781]	 Loss: 4.209928035736084
Step [600/781]	 Loss: 4.198174953460693
Step [650/781]	 Loss: 4.243295669555664
Step [700/781]	 Loss: 4.298521518707275
Step [750/781]	 Loss: 4.294758319854736
Epoch [16/100]	 Loss: 4.240055734461004	 lr: 0.07036
Step [0/781]	 Loss: 4.227541923522949
Step [50/781]	 Loss: 4.302923202514648
Step [100/781]	 Loss: 4.254132270812988
Step [150/781]	 Loss: 4.1884684562683105
Step [200/781]	 Loss: 4.193136215209961
Step [250/781]	 Loss: 4.266998767852783
Step [300/781]	 Loss: 4.1638102531433105
Step [350/781]	 Loss: 4.09047794342041
Step [400/781]	 Loss: 4.238276481628418
Step [450/781]	 Loss: 4.140978813171387
Step [500/781]	 Loss: 4.328328609466553
Step [550/781]	 Loss: 4.283865451812744
Step [600/781]	 Loss: 4.348247528076172
Step [650/781]	 Loss: 4.2050981521606445
Step [700/781]	 Loss: 4.277124404907227
Step [750/781]	 Loss: 4.211368560791016
Epoch [17/100]	 Loss: 4.234389183615906	 lr: 0.06978
Step [0/781]	 Loss: 4.289071559906006
Step [50/781]	 Loss: 4.215389251708984
Step [100/781]	 Loss: 4.176078796386719
Step [150/781]	 Loss: 4.316470623016357
Step [200/781]	 Loss: 4.299121856689453
Step [250/781]	 Loss: 4.2952961921691895
Step [300/781]	 Loss: 4.182873725891113
Step [350/781]	 Loss: 4.2015838623046875
Step [400/781]	 Loss: 4.055173397064209
Step [450/781]	 Loss: 4.202243328094482
Step [500/781]	 Loss: 4.350408554077148
Step [550/781]	 Loss: 4.287383079528809
Step [600/781]	 Loss: 4.2284088134765625
Step [650/781]	 Loss: 4.152432918548584
Step [700/781]	 Loss: 4.158289909362793
Step [750/781]	 Loss: 4.238840579986572
Epoch [18/100]	 Loss: 4.225370582331463	 lr: 0.06916
Step [0/781]	 Loss: 4.1328277587890625
Step [50/781]	 Loss: 4.228924751281738
Step [100/781]	 Loss: 4.207979679107666
Step [150/781]	 Loss: 4.31138801574707
Step [200/781]	 Loss: 4.270506381988525
Step [250/781]	 Loss: 4.191015243530273
Step [300/781]	 Loss: 4.159777641296387
Step [350/781]	 Loss: 4.241746425628662
Step [400/781]	 Loss: 4.293455600738525
Step [450/781]	 Loss: 4.166689872741699
Step [500/781]	 Loss: 4.139820098876953
Step [550/781]	 Loss: 4.2261247634887695
Step [600/781]	 Loss: 4.235036849975586
Step [650/781]	 Loss: 4.292981147766113
Step [700/781]	 Loss: 4.074502944946289
Step [750/781]	 Loss: 4.292132377624512
Epoch [19/100]	 Loss: 4.217801521438032	 lr: 0.06852
Step [0/781]	 Loss: 4.211063861846924
Step [50/781]	 Loss: 4.223503112792969
Step [100/781]	 Loss: 4.265060901641846
Step [150/781]	 Loss: 4.092151641845703
Step [200/781]	 Loss: 4.2852606773376465
Step [250/781]	 Loss: 4.22372579574585
Step [300/781]	 Loss: 4.217098236083984
Step [350/781]	 Loss: 4.292943477630615
Step [400/781]	 Loss: 4.267622470855713
Step [450/781]	 Loss: 4.253868103027344
Step [500/781]	 Loss: 4.103015899658203
Step [550/781]	 Loss: 4.212114334106445
Step [600/781]	 Loss: 4.339046478271484
Step [650/781]	 Loss: 4.2768988609313965
Step [700/781]	 Loss: 4.088725566864014
Step [750/781]	 Loss: 4.214448928833008
Epoch [20/100]	 Loss: 4.214141008643273	 lr: 0.06784
